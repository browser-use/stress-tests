<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Final Form</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
            padding-bottom: 50px;
        }
        
        .form-container {
            max-width: 800px;
            margin: 20px auto;
            padding: 30px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .form-section {
            margin-bottom: 35px;
            padding: 25px;
            background-color: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }
        
        .form-section h3 {
            margin-top: 0;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e9ecef;
            color: #495057;
            font-weight: 600;
        }
        
        .error-text {
            color: #dc3545;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            font-weight: 500;
        }
        
        .error-field {
            border-color: #dc3545;
            background-color: #fff8f8;
        }
        
        .label-required:after {
            content: " *";
            color: #dc3545;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-container {
            background-color: white;
            padding: 25px;
            border-radius: 12px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .modal-header h4 {
            margin: 0;
            color: #495057;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6c757d;
        }
        
        .modal-footer {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: flex-end;
        }
        
        .btn-submit {
            background-color: #20c997;
            border-color: #20c997;
        }
        
        .btn-submit:hover {
            background-color: #1ba87e;
            border-color: #1ba87e;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mt-4 mb-3 text-center">React Final Form</h1>
        <p class="text-center mb-4">This React Final Form example uses React Final Form library to create a fully interactive form with validation.</p>
        
        <div id="root"></div>
    </div>
    
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- React Final Form -->
    <script src="https://unpkg.com/final-form@4.20.9/dist/final-form.umd.production.min.js"></script>
    <script src="https://unpkg.com/react-final-form@6.5.9/dist/react-final-form.umd.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { Form, Field } = ReactFinalForm;
        
        // Field component with error display
        const FormField = ({ name, label, type, required, children, ...props }) => {
            return (
                <Field name={name} validate={required ? value => (value ? undefined : 'Required') : undefined}>
                    {({ input, meta }) => (
                        <div className="mb-3">
                            <label htmlFor={name} className={`form-label ${required ? 'label-required' : ''}`}>{label}</label>
                            {type === 'select' ? (
                                <select {...input} {...props} id={name} className={`form-select ${meta.error && meta.touched ? 'error-field' : ''}`}>
                                    {children}
                                </select>
                            ) : type === 'textarea' ? (
                                <textarea {...input} {...props} id={name} className={`form-control ${meta.error && meta.touched ? 'error-field' : ''}`} />
                            ) : (
                                <input {...input} type={type} {...props} id={name} className={`form-control ${meta.error && meta.touched ? 'error-field' : ''}`} />
                            )}
                            {meta.error && meta.touched && <div className="error-text">{meta.error}</div>}
                        </div>
                    )}
                </Field>
            );
        };
        
        // Radio group component
        const RadioGroup = ({ name, label, options }) => {
            return (
                <div className="mb-3">
                    <label className="form-label">{label}</label>
                    {options.map((option, index) => (
                        <Field key={index} name={name} type="radio" value={option.value} render={({ input }) => (
                            <div className="form-check">
                                <input {...input} id={`${name}-${option.value}`} className="form-check-input" />
                                <label htmlFor={`${name}-${option.value}`} className="form-check-label">{option.label}</label>
                            </div>
                        )} />
                    ))}
                </div>
            );
        };
        
        // Checkbox component
        const Checkbox = ({ name, label }) => {
            return (
                <Field name={name} type="checkbox" render={({ input, meta }) => (
                    <div className="form-check mb-3">
                        <input {...input} id={name} className={`form-check-input ${meta.error && meta.touched ? 'is-invalid' : ''}`} />
                        <label htmlFor={name} className="form-check-label">{label}</label>
                        {meta.error && meta.touched && <div className="error-text">{meta.error}</div>}
                    </div>
                )} />
            );
        };
        
        // Validation functions
        const required = value => (value ? undefined : 'Required');
        const email = value => (value && !/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(value) ? 'Invalid email address' : undefined);
        const phoneFormat = value => (value && !/^\d{3}-\d{3}-\d{4}$/.test(value) ? 'Phone must be in format: 123-456-7890' : undefined);
        const zipCode = value => (value && !/^\d{5}(-\d{4})?$/.test(value) ? 'Invalid zip code format' : undefined);
        const minValue = min => value => (value && parseFloat(value) < min ? `Should be greater than ${min}` : undefined);
        const composeValidators = (...validators) => value => validators.reduce((error, validator) => error || validator(value), undefined);
        
        function FinalFormExample() {
            const [showModal, setShowModal] = React.useState(false);
            const [showSuccess, setShowSuccess] = React.useState(false);
            const [shippingSameAsBilling, setShippingSameAsBilling] = React.useState(false);
            const [fileName, setFileName] = React.useState('No file selected');
            
            const handleOpenModal = () => {
                setShowModal(true);
            };
            
            const handleCloseModal = () => {
                setShowModal(false);
            };
            
            const handleFileChange = (e) => {
                if (e.target.files && e.target.files.length > 0) {
                    setFileName(e.target.files[0].name);
                } else {
                    setFileName('No file selected');
                }
            };
            
            const handleSameShippingChange = (e) => {
                setShippingSameAsBilling(e.target.checked);
            };
            
            const handleTermsClick = (e) => {
                e.preventDefault();
                alert('Terms and Conditions would be displayed here.');
            };
            
            const onSubmit = async values => {
                // In a real app, you would submit to an API here
                console.log('Form submitted successfully!', values);
                setShowSuccess(true);
                setTimeout(() => {
                    setShowSuccess(false);
                }, 3000);
            };
            
            return (
                <div>
                    {showSuccess && (
                        <div className="alert alert-success" role="alert">
                            <strong>Success!</strong> Form submitted successfully!
                        </div>
                    )}
                    
                    <Form
                        onSubmit={onSubmit}
                        initialValues={{
                            contactPreference: 'email',
                            sameShipping: false,
                            quantity: 1
                        }}
                        render={({ handleSubmit, form, submitting, pristine, values }) => (
                            <form onSubmit={handleSubmit} className="form-container">
                                {/* Customer Information Section */}
                                <div className="form-section">
                                    <h3>Customer Information</h3>
                                    
                                    <div className="row mb-3">
                                        <div className="col-md-6">
                                            <FormField
                                                name="firstName"
                                                label="First Name"
                                                type="text"
                                                required
                                                placeholder="Enter first name"
                                            />
                                        </div>
                                        
                                        <div className="col-md-6">
                                            <FormField
                                                name="lastName"
                                                label="Last Name"
                                                type="text"
                                                required
                                                placeholder="Enter last name"
                                            />
                                        </div>
                                    </div>
                                    
                                    <div className="row mb-3">
                                        <div className="col-md-6">
                                            <FormField
                                                name="email"
                                                label="Email Address"
                                                type="email"
                                                required
                                                validate={composeValidators(required, email)}
                                                placeholder="Email address"
                                            />
                                        </div>
                                        
                                        <div className="col-md-6">
                                            <FormField
                                                name="phone"
                                                label="Phone Number"
                                                type="tel"
                                                validate={phoneFormat}
                                                placeholder="123-456-7890"
                                            />
                                        </div>
                                    </div>
                                    
                                    <div className="row mb-3">
                                        <div className="col-md-6">
                                            <FormField
                                                name="company"
                                                label="Company"
                                                type="text"
                                                placeholder="Company name (optional)"
                                            />
                                        </div>
                                        
                                        <div className="col-md-6">
                                            <FormField
                                                name="jobTitle"
                                                label="Job Title"
                                                type="text"
                                                placeholder="Job title (optional)"
                                            />
                                        </div>
                                    </div>
                                </div>
                                
                                {/* Billing Address Section */}
                                <div className="form-section">
                                    <h3>Billing Address</h3>
                                    
                                    <FormField
                                        name="billingAddress.street"
                                        label="Street Address"
                                        type="text"
                                        required
                                        placeholder="Street address"
                                    />
                                    
                                    <FormField
                                        name="billingAddress.line2"
                                        label="Address Line 2"
                                        type="text"
                                        placeholder="Apartment, suite, unit, etc."
                                    />
                                    
                                    <div className="row mb-3">
                                        <div className="col-md-6">
                                            <FormField
                                                name="billingAddress.city"
                                                label="City"
                                                type="text"
                                                required
                                                placeholder="City"
                                            />
                                        </div>
                                        
                                        <div className="col-md-3">
                                            <FormField
                                                name="billingAddress.state"
                                                label="State"
                                                type="select"
                                                required
                                            >
                                                <option value="">Select state</option>
                                                <option value="AL">Alabama</option>
                                                <option value="AK">Alaska</option>
                                                <option value="AZ">Arizona</option>
                                                {/* More states would be listed here */}
                                                <option value="WY">Wyoming</option>
                                            </FormField>
                                        </div>
                                        
                                        <div className="col-md-3">
                                            <FormField
                                                name="billingAddress.zipCode"
                                                label="Zip Code"
                                                type="text"
                                                required
                                                validate={composeValidators(required, zipCode)}
                                                placeholder="Zip code"
                                            />
                                        </div>
                                    </div>
                                    
                                    <FormField
                                        name="billingAddress.country"
                                        label="Country"
                                        type="select"
                                        required
                                    >
                                        <option value="">Select country</option>
                                        <option value="US">United States</option>
                                        <option value="CA">Canada</option>
                                        <option value="UK">United Kingdom</option>
                                        <option value="AU">Australia</option>
                                        {/* More countries would be listed here */}
                                    </FormField>
                                    
                                    <div className="form-check mb-3">
                                        <input
                                            type="checkbox"
                                            className="form-check-input"
                                            id="sameShipping"
                                            name="sameShipping"
                                            checked={shippingSameAsBilling}
                                            onChange={handleSameShippingChange}
                                        />
                                        <label className="form-check-label" htmlFor="sameShipping">
                                            Shipping address is same as billing
                                        </label>
                                    </div>
                                </div>
                                
                                {/* Shipping Address Section */}
                                {!shippingSameAsBilling && (
                                    <div className="form-section" id="shipping-section">
                                        <h3>Shipping Address</h3>
                                        
                                        <FormField
                                            name="shippingAddress.street"
                                            label="Street Address"
                                            type="text"
                                            required
                                            placeholder="Street address"
                                        />
                                        
                                        <FormField
                                            name="shippingAddress.line2"
                                            label="Address Line 2"
                                            type="text"
                                            placeholder="Apartment, suite, unit, etc."
                                        />
                                        
                                        <div className="row mb-3">
                                            <div className="col-md-6">
                                                <FormField
                                                    name="shippingAddress.city"
                                                    label="City"
                                                    type="text"
                                                    required
                                                    placeholder="City"
                                                />
                                            </div>
                                            
                                            <div className="col-md-3">
                                                <FormField
                                                    name="shippingAddress.state"
                                                    label="State"
                                                    type="select"
                                                    required
                                                >
                                                    <option value="">Select state</option>
                                                    <option value="AL">Alabama</option>
                                                    <option value="AK">Alaska</option>
                                                    <option value="AZ">Arizona</option>
                                                    {/* More states would be listed here */}
                                                    <option value="WY">Wyoming</option>
                                                </FormField>
                                            </div>
                                            
                                            <div className="col-md-3">
                                                <FormField
                                                    name="shippingAddress.zipCode"
                                                    label="Zip Code"
                                                    type="text"
                                                    required
                                                    validate={composeValidators(required, zipCode)}
                                                    placeholder="Zip code"
                                                />
                                            </div>
                                        </div>
                                        
                                        <FormField
                                            name="shippingAddress.country"
                                            label="Country"
                                            type="select"
                                            required
                                        >
                                            <option value="">Select country</option>
                                            <option value="US">United States</option>
                                            <option value="CA">Canada</option>
                                            <option value="UK">United Kingdom</option>
                                            <option value="AU">Australia</option>
                                            {/* More countries would be listed here */}
                                        </FormField>
                                    </div>
                                )}
                                
                                {/* Order Details Section */}
                                <div className="form-section">
                                    <h3>Order Details</h3>
                                    
                                    <FormField
                                        name="order.product"
                                        label="Product"
                                        type="select"
                                        required
                                    >
                                        <option value="">Select a product</option>
                                        <option value="product1">Product 1 - $99.99</option>
                                        <option value="product2">Product 2 - $149.99</option>
                                        <option value="product3">Product 3 - $199.99</option>
                                        <option value="product4">Product 4 - $249.99</option>
                                    </FormField>
                                    
                                    <FormField
                                        name="order.quantity"
                                        label="Quantity"
                                        type="number"
                                        required
                                        validate={composeValidators(required, minValue(1))}
                                        min="1"
                                        placeholder="Quantity"
                                    />
                                    
                                    <FormField
                                        name="order.deliveryDate"
                                        label="Requested Delivery Date"
                                        type="date"
                                    />
                                    
                                    <FormField
                                        name="order.deliveryTime"
                                        label="Preferred Delivery Time"
                                        type="time"
                                    />
                                    
                                    <FormField
                                        name="order.specialInstructions"
                                        label="Special Instructions"
                                        type="textarea"
                                        rows="3"
                                        placeholder="Special instructions for your order"
                                    />
                                </div>
                                
                                {/* Payment Section */}
                                <div className="form-section">
                                    <h3>Payment Information</h3>
                                    
                                    <RadioGroup
                                        name="payment.method"
                                        label="Payment Method"
                                        options={[
                                            { value: 'creditCard', label: 'Credit Card' },
                                            { value: 'paypal', label: 'PayPal' },
                                            { value: 'bankTransfer', label: 'Bank Transfer' }
                                        ]}
                                    />
                                    
                                    {/* Credit Card Fields */}
                                    <div id="creditCardFields">
                                        <div className="row mb-3">
                                            <div className="col-md-6">
                                                <FormField
                                                    name="payment.cardName"
                                                    label="Name on Card"
                                                    type="text"
                                                    placeholder="Name on card"
                                                />
                                            </div>
                                            
                                            <div className="col-md-6">
                                                <FormField
                                                    name="payment.cardNumber"
                                                    label="Card Number"
                                                    type="text"
                                                    placeholder="1234 5678 9012 3456"
                                                />
                                            </div>
                                        </div>
                                        
                                        <div className="row mb-3">
                                            <div className="col-md-4">
                                                <FormField
                                                    name="payment.expiryMonth"
                                                    label="Expiry Month"
                                                    type="select"
                                                >
                                                    <option value="">Month</option>
                                                    <option value="01">01 - January</option>
                                                    <option value="02">02 - February</option>
                                                    <option value="03">03 - March</option>
                                                    <option value="04">04 - April</option>
                                                    <option value="05">05 - May</option>
                                                    <option value="06">06 - June</option>
                                                    <option value="07">07 - July</option>
                                                    <option value="08">08 - August</option>
                                                    <option value="09">09 - September</option>
                                                    <option value="10">10 - October</option>
                                                    <option value="11">11 - November</option>
                                                    <option value="12">12 - December</option>
                                                </FormField>
                                            </div>
                                            
                                            <div className="col-md-4">
                                                <FormField
                                                    name="payment.expiryYear"
                                                    label="Expiry Year"
                                                    type="select"
                                                >
                                                    <option value="">Year</option>
                                                    <option value="2023">2023</option>
                                                    <option value="2024">2024</option>
                                                    <option value="2025">2025</option>
                                                    <option value="2026">2026</option>
                                                    <option value="2027">2027</option>
                                                    <option value="2028">2028</option>
                                                </FormField>
                                            </div>
                                            
                                            <div className="col-md-4">
                                                <FormField
                                                    name="payment.cvv"
                                                    label="CVV"
                                                    type="text"
                                                    placeholder="123"
                                                    maxLength="4"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                {/* Additional Fields Section */}
                                <div className="form-section">
                                    <h3>Additional Fields</h3>
                                    
                                    <FormField
                                        name="alphanumericOnly"
                                        label="Alphanumeric Only"
                                        type="text"
                                        placeholder="Only letters and numbers"
                                        parse={(value) => value.replace(/[^a-zA-Z0-9]/g, '')}
                                    />
                                    
                                    <div className="mb-3">
                                        <label htmlFor="disabledInput" className="form-label">Disabled Input</label>
                                        <input
                                            type="text"
                                            id="disabledInput"
                                            name="disabledInput"
                                            className="form-control"
                                            value="This field is disabled"
                                            disabled
                                        />
                                    </div>
                                    
                                    <FormField
                                        name="referralSource"
                                        label="How did you hear about us?"
                                        type="select"
                                    >
                                        <option value="">Select an option</option>
                                        <option value="search">Search Engine</option>
                                        <option value="social">Social Media</option>
                                        <option value="friend">Friend or Colleague</option>
                                        <option value="ad">Advertisement</option>
                                        <option value="other">Other</option>
                                    </FormField>
                                    
                                    <div className="mb-3">
                                        <label className="form-label">File Upload</label>
                                        <input
                                            type="file"
                                            id="fileUpload"
                                            name="fileUpload"
                                            className="form-control"
                                            onChange={handleFileChange}
                                        />
                                    </div>
                                    
                                    <Checkbox
                                        name="newsletter"
                                        label="Subscribe to our newsletter"
                                    />
                                    
                                    <Field name="termsAgreement" validate={required}>
                                        {({ input, meta }) => (
                                            <div className="form-check mb-3">
                                                <input {...input} type="checkbox" id="termsAgreement" className={`form-check-input ${meta.error && meta.touched ? 'is-invalid' : ''}`} />
                                                <label className="form-check-label" htmlFor="termsAgreement">
                                                    I agree to the <a href="#" onClick={handleTermsClick}>Terms and Conditions</a> <span className="text-danger">*</span>
                                                </label>
                                                {meta.error && meta.touched && <div className="error-text">{meta.error}</div>}
                                            </div>
                                        )}
                                    </Field>
                                </div>
                                
                                <div className="d-flex gap-2 mb-3">
                                    <button
                                        type="submit"
                                        className="btn btn-primary btn-submit"
                                        disabled={submitting}
                                    >
                                        Submit Order
                                    </button>
                                    <button
                                        type="button"
                                        className="btn btn-danger"
                                        onClick={handleOpenModal}
                                    >
                                        Open Modal
                                    </button>
                                    <button
                                        type="button"
                                        className="btn btn-secondary"
                                        onClick={form.reset}
                                        disabled={submitting || pristine}
                                    >
                                        Reset Form
                                    </button>
                                </div>
                            </form>
                        )}
                    />
                    
                    {/* Red Herring Modal */}
                    {showModal && (
                        <div className="modal-overlay">
                            <div className="modal-container">
                                <div className="modal-header">
                                    <h4>Red Herring Modal</h4>
                                    <button type="button" className="modal-close" onClick={handleCloseModal}>&times;</button>
                                </div>
                                <div className="modal-body">
                                    <p>This is a red herring modal instead of submitting the form.</p>
                                    <p>In a real application, this might contain additional options or information.</p>
                                </div>
                                <div className="modal-footer">
                                    <button type="button" className="btn btn-secondary" onClick={handleCloseModal}>Close</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }
        
        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FinalFormExample />);
    </script>
</body>
</html>